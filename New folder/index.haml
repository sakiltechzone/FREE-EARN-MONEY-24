<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SAKIL TECH ZONE</title>

  <script src='//libtl.com/sdk.js' data-zone='10543110' data-sdk='show_10543110'></script>

  <script src="https://cdn.tailwindcss.com"></script>
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    body { font-family: 'Inter', sans-serif; background-color: #0f0f0f; color: #ffffff; }
    .dark-bg { background-color: #0f0f0f; }
    .card-bg { background-color: #1a1a1a; }
    .text-accent { color: #ff8c00; }
    
    /* Smooth Button Animation */
    .btn-anim { transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); }
    .btn-anim:active { transform: scale(0.95); }
    
    .input-field { background-color: #262626; border: 1px solid #404040; color: white; }
    
    .main-page { display: none; }
    .main-page.active { display: flex; animation: fadeIn 0.4s ease-out; }
    
    .sub-page { display: none; }
    .sub-page.active { display: block; animation: fadeIn 0.3s ease-out; }
    
    .bottom-nav a.active { color: #ff8c00; }
    
    .notification-dot {
      position: absolute; top: -2px; right: -2px; width: 10px; height: 10px;
      background-color: #ef4444; border-radius: 50%; border: 2px solid #121212; display: none;
    }
    
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .ip-warning { background-color: #ef4444; color: white; padding: 12px; border-radius: 12px; margin-bottom: 20px; text-align: center; display: none; font-weight: 600; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3); }

    /* UPDATED: Slower Marquee Animation */
    @keyframes marquee {
        0% { transform: translateX(100%); }
        100% { transform: translateX(-150%); }
    }
    .animate-marquee {
        display: inline-block;
        white-space: nowrap;
        animation: marquee 25s linear infinite; /* Slowed down to 25s */
        padding-left: 10px; 
    }
  </style>
</head>

<body class="max-w-md mx-auto bg-[#0f0f0f] min-h-screen">

  <div id="loader" class="hidden fixed inset-0 dark-bg bg-opacity-80 flex items-center justify-center z-50 backdrop-blur-sm">
    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"></div>
  </div>

  <div id="ip-warning" class="ip-warning">
    ‚ö†Ô∏è Warning: Multiple device detected!
  </div>

  <div id="timer-modal" class="hidden fixed inset-0 bg-black/95 flex items-center justify-center z-50 p-6 backdrop-blur-md">
    <div class="bg-gray-900 rounded-2xl p-8 w-full max-w-sm text-center border border-gray-800">
      <h3 class="text-xl font-bold mb-4 text-orange-500">Please Wait</h3>
      <div class="text-5xl font-black mb-6 font-mono" id="countdown-display">0</div>
      <p class="text-gray-400 text-sm">‡¶ï‡¶æ‡¶ú‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§<br>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶¨‡ßá‡¶® ‡¶®‡¶æ‡•§</p>
    </div>
  </div>

  <div id="auth-section" class="min-h-screen p-6 flex-col justify-center main-page">
    <div class="text-center mb-10">
      <div class="w-20 h-20 bg-gradient-to-tr from-orange-500 to-red-600 rounded-2xl mx-auto flex items-center justify-center mb-4 shadow-lg shadow-orange-500/20">
        <i data-lucide="zap" class="w-10 h-10 text-white"></i>
      </div>
      <h1 class="text-3xl font-bold text-white tracking-tight">FREE EARN MONEY 24</h1>
      <p class="text-gray-500 mt-2">Login to start earning</p>
    </div>

    <div id="auth-container">
      <div id="login-view">
        <input id="login-email" type="email" placeholder="Email Address" class="w-full p-4 rounded-xl input-field mb-4 focus:border-orange-500 outline-none transition-colors">
        <input id="login-password" type="password" placeholder="Password" class="w-full p-4 rounded-xl input-field mb-6 focus:border-orange-500 outline-none transition-colors">
        <button id="login-btn" class="w-full p-4 rounded-xl bg-gradient-to-r from-orange-500 to-red-600 font-bold text-white shadow-lg shadow-orange-500/30 btn-anim">Login</button>
        <p class="text-center text-gray-400 mt-6">Don't have an account?
          <a href="#" id="show-signup" class="font-semibold text-orange-500 hover:text-orange-400">Sign Up</a>
        </p>
      </div>

      <div id="signup-view" class="hidden">
        <input id="signup-name" type="text" placeholder="Full Name" class="w-full p-4 rounded-xl input-field mb-4 focus:border-orange-500 outline-none">
        <input id="signup-email" type="email" placeholder="Email Address" class="w-full p-4 rounded-xl input-field mb-4 focus:border-orange-500 outline-none">
        <input id="signup-password" type="password" placeholder="Password" class="w-full p-4 rounded-xl input-field mb-6 focus:border-orange-500 outline-none">
        <button id="signup-btn" class="w-full p-4 rounded-xl bg-gradient-to-r from-orange-500 to-red-600 font-bold text-white shadow-lg shadow-orange-500/30 btn-anim">Create Account</button>
        <p class="text-center text-gray-400 mt-6">Already have an account?
          <a href="#" id="show-login" class="font-semibold text-orange-500 hover:text-orange-400">Login</a>
        </p>
      </div>
    </div>
  </div>

  <div id="app-container" class="min-h-screen flex-col main-page pb-24">
    <header class="flex items-center justify-between p-5 sticky top-0 bg-[#0f0f0f]/90 backdrop-blur-md z-10 border-b border-gray-800">
      <h1 class="text-lg font-bold flex items-center gap-2">
        <div class="w-8 h-8 bg-gradient-to-br from-orange-500 to-red-500 rounded-lg flex items-center justify-center">
          <i data-lucide="zap" class="w-4 h-4 text-white"></i>
        </div>
        FREE EARN MONEY 24 
      </h1>
      <div class="flex items-center space-x-3">
        <div class="bg-gray-800 p-2 rounded-full cursor-pointer hover:bg-gray-700 transition-colors" onclick="navigateTo('history-page')">
          <i data-lucide="history" class="w-5 h-5 text-gray-300"></i>
        </div>
        <div class="bg-gray-800 p-2 rounded-full cursor-pointer hover:bg-gray-700 transition-colors" onclick="navigateTo('profile-page')">
          <i data-lucide="user" class="w-5 h-5 text-gray-300"></i>
        </div>
      </div>
    </header>

    <div id="global-notification-bar" class="hidden mx-4 mt-4">
        <div class="bg-gray-800/80 backdrop-blur-md border border-amber-500/30 rounded-full py-1.5 pl-1.5 pr-4 flex items-center shadow-lg shadow-amber-500/10 relative overflow-hidden">
            <div class="bg-amber-500 text-black rounded-full p-1.5 shrink-0 z-10 flex items-center justify-center shadow-md">
                <i data-lucide="megaphone" class="w-3.5 h-3.5"></i>
            </div>
            <div class="flex-1 overflow-hidden relative h-6 ml-3">
                 <div id="notification-text" class="animate-marquee text-white text-sm font-semibold whitespace-nowrap absolute top-0.5">
                    Loading...
                 </div>
            </div>
        </div>
    </div>

    <main class="flex-grow">
      <div id="home-page" class="p-5 space-y-6 sub-page">
        <div class="bg-gradient-to-r from-gray-800 to-gray-900 p-5 rounded-2xl border border-gray-700 shadow-xl">
          <div class="flex justify-between items-start mb-6">
            <div>
              <p class="text-gray-400 text-xs font-medium uppercase tracking-wider mb-1">Total Balance</p>
              <div class="flex flex-col">
                  <p class="text-4xl font-black text-white flex items-center gap-1">
                    <span id="coin-balance">0.00</span>
                    <span class="text-sm font-normal text-yellow-500">ü™ô</span>
                  </p>
                  <p class="text-sm font-bold text-emerald-400 mt-1 flex items-center gap-1">
                    <span id="dollar-balance">‚âà $0.0000</span>
                  </p>
              </div>
            </div>
            <button onclick="navigateTo('history-page')" class="p-2 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition">
              <i data-lucide="file-text" class="w-5 h-5 text-gray-300"></i>
            </button>
          </div>
          
          <div class="grid grid-cols-2 gap-3">
            <button onclick="navigateTo('deposit-page')" class="bg-gradient-to-r from-emerald-500 to-green-600 text-white font-bold px-4 py-3 rounded-xl text-sm hover:shadow-lg hover:shadow-emerald-500/20 btn-anim flex items-center justify-center gap-2">
              <i data-lucide="arrow-down-circle" class="w-4 h-4"></i> Deposit
            </button>
            <button onclick="navigateTo('wallet-page')" class="bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold px-4 py-3 rounded-xl text-sm hover:shadow-lg hover:shadow-orange-500/20 btn-anim flex items-center justify-center gap-2">
              <i data-lucide="arrow-up-circle" class="w-4 h-4"></i> Withdraw
            </button>
          </div>
        </div>

        <section>
          <div class="flex justify-between items-end mb-4">
            <div>
              <h2 class="text-xl font-bold text-white">Daily Tasks</h2>
              <p class="text-xs text-gray-500 mt-1">Complete tasks to earn coins</p>
            </div>
            <div class="text-xs font-mono bg-gray-800 px-3 py-1 rounded-full text-gray-300">
              Left: <span id="ads-left-count" class="text-orange-500 font-bold">...</span>
            </div>
          </div>

          <div class="space-y-4">
            <div class="group relative overflow-hidden bg-[#161616] p-4 rounded-2xl border border-gray-800 flex items-center justify-between hover:border-orange-500/30 transition-colors duration-300">
              <div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-orange-500 to-red-600"></div>
              <div class="flex items-center space-x-4">
                <div class="p-3 bg-orange-500/10 rounded-xl text-orange-500"><i data-lucide="play-circle" class="w-6 h-6"></i></div>
                <div><h3 class="font-bold text-gray-100">Watch Video Ad</h3><p class="text-xs text-gray-500">Instant Reward</p></div>
              </div>
              <button class="btn-anim bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold px-6 py-2.5 rounded-xl text-sm shadow-lg shadow-orange-500/30" onclick="claimReward('interstitial')">Claim</button>
            </div>

            <div class="group relative overflow-hidden bg-[#161616] p-4 rounded-2xl border border-gray-800 flex items-center justify-between hover:border-red-500/30 transition-colors duration-300">
              <div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-red-500 to-rose-600"></div>
              <div class="flex items-center space-x-4">
                <div class="p-3 bg-red-500/10 rounded-xl text-red-500"><i data-lucide="youtube" class="w-6 h-6"></i></div>
                <div><h3 class="font-bold text-gray-100">YouTube Task</h3><p class="text-xs text-gray-500">Subscribe Watch</p></div>
              </div>
              <button class="btn-anim bg-gradient-to-r from-red-600 to-rose-600 text-white font-bold px-6 py-2.5 rounded-xl text-sm shadow-lg shadow-red-500/30" onclick="visitWebsite('https://sakiltechzone.blogspot.com', 20)">Claim</button>
            </div>

            <div class="group relative overflow-hidden bg-[#161616] p-4 rounded-2xl border border-gray-800 flex items-center justify-between hover:border-blue-500/30 transition-colors duration-300">
              <div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-blue-500 to-indigo-600"></div>
              <div class="flex items-center space-x-4">
                <div class="p-3 bg-blue-500/10 rounded-xl text-blue-500"><i data-lucide="facebook" class="w-6 h-6"></i></div>
                <div><h3 class="font-bold text-gray-100">Facebook Task</h3><p class="text-xs text-gray-500">Page Follow</p></div>
              </div>
              <button class="btn-anim bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold px-6 py-2.5 rounded-xl text-sm shadow-lg shadow-blue-500/30" onclick="visitWebsite('https://sakiltechzone.blogspot.com', 20)">Claim</button>
            </div>

            <div class="group relative overflow-hidden bg-[#161616] p-4 rounded-2xl border border-gray-800 flex items-center justify-between hover:border-pink-500/30 transition-colors duration-300">
              <div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-pink-500 to-fuchsia-600"></div>
              <div class="flex items-center space-x-4">
                <div class="p-3 bg-pink-500/10 rounded-xl text-pink-500"><i data-lucide="music-2" class="w-6 h-6"></i></div>
                <div><h3 class="font-bold text-gray-100">TikTok Task</h3><p class="text-xs text-gray-500">Follow ID</p></div>
              </div>
              <button class="btn-anim bg-gradient-to-r from-pink-500 to-fuchsia-600 text-white font-bold px-6 py-2.5 rounded-xl text-sm shadow-lg shadow-pink-500/30" onclick="visitWebsite('https://sakiltechzone.blogspot.com', 20)">Claim</button>
            </div>

            <div class="group relative overflow-hidden bg-[#161616] p-4 rounded-2xl border border-gray-800 flex items-center justify-between hover:border-amber-500/30 transition-colors duration-300">
              <div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-amber-400 to-yellow-600"></div>
              <div class="flex items-center space-x-4">
                <div class="p-3 bg-amber-500/10 rounded-xl text-amber-400"><i data-lucide="mouse-pointer" class="w-6 h-6"></i></div>
                <div><h3 class="font-bold text-gray-100">Special Task</h3><p class="text-xs text-gray-500">Wait 30 Seconds</p></div>
              </div>
              <button class="btn-anim bg-gradient-to-r from-amber-400 to-yellow-500 text-black font-bold px-6 py-2.5 rounded-xl text-sm shadow-lg shadow-amber-500/30" onclick="visitWebsite('https://performhouseholduneasy.com/bs8d1u99ty?key=a9cf6fe10795fdc635e6de8376d2c371', 30)">Start</button>
            </div>

            <div class="group relative overflow-hidden bg-[#161616] p-4 rounded-2xl border border-gray-800 flex items-center justify-between hover:border-emerald-500/30 transition-colors duration-300">
              <div class="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-emerald-400 to-green-600"></div>
              <div class="flex items-center space-x-4">
                <div class="p-3 bg-emerald-500/10 rounded-xl text-emerald-400"><i data-lucide="gamepad-2" class="w-6 h-6"></i></div>
                <div><h3 class="font-bold text-gray-100">Play Mini Game</h3><p class="text-xs text-gray-500">Big Reward!</p></div>
              </div>
              <button class="btn-anim bg-gradient-to-r from-emerald-500 to-green-600 text-white font-bold px-6 py-2.5 rounded-xl text-sm shadow-lg shadow-emerald-500/30" onclick="claimReward('miniApp')">Play</button>
            </div>
          </div>
        </section>
      </div>

      <div id="deposit-page" class="p-5 space-y-6 sub-page">
        <h2 class="text-xl font-bold text-center mb-4">Add Funds</h2>
        
        <p class="text-sm text-gray-400 mb-2">Select Payment Method</p>
        <div class="grid grid-cols-2 gap-3 mb-6">
          <button onclick="selectDepositMethod('Binance')" class="bg-[#1a1a1a] border border-gray-700 p-4 rounded-xl hover:border-yellow-500 transition-colors flex flex-col items-center gap-2">
            <img src="https://cryptologos.cc/logos/binance-coin-bnb-logo.png" alt="Binance" class="w-10 h-10 object-contain">
            <span class="text-xs font-bold">Binance</span>
          </button>
          <button onclick="selectDepositMethod('Nagad')" class="bg-[#1a1a1a] border border-gray-700 p-4 rounded-xl hover:border-orange-600 transition-colors flex flex-col items-center gap-2">
            <img src="https://freelogopng.com/images/all_img/1679248787Nagad-Logo.png" alt="Nagad" class="w-14 h-10 object-contain">
            <span class="text-xs font-bold">Nagad</span>
          </button>
          <button onclick="selectDepositMethod('Bkash')" class="bg-[#1a1a1a] border border-gray-700 p-4 rounded-xl hover:border-pink-600 transition-colors flex flex-col items-center gap-2">
            <img src="https://freelogopng.com/images/all_img/1656234745bkash-app-logo-png.png" alt="Bkash" class="w-14 h-10 object-contain">
            <span class="text-xs font-bold">Bkash</span>
          </button>
          <button onclick="selectDepositMethod('PhonePe')" class="bg-[#1a1a1a] border border-gray-700 p-4 rounded-xl hover:border-indigo-500 transition-colors flex flex-col items-center gap-2">
            <img src="https://www.google.com/s2/favicons?domain=phonepe.com&sz=128" alt="PhonePe" class="w-14 h-10 object-contain">
            <span class="text-xs font-bold">PhonePe</span>
          </button>
        </div>

        <div id="deposit-form" class="hidden bg-gray-800 p-6 rounded-2xl border border-gray-700 animate-fade-in">
          <h3 id="selected-method-name" class="font-bold text-lg mb-2 text-white">Selected Method</h3>
          
          <div class="bg-black/30 p-3 rounded-lg border border-gray-600 mb-4 flex justify-between items-center">
            <span id="payment-details" class="text-xs font-mono text-gray-300 break-all select-all">Loading address...</span>
            <button onclick="copyPaymentAddress()" class="text-gray-400 hover:text-white p-2 rounded hover:bg-gray-700 transition">
              <i data-lucide="copy" class="w-4 h-4"></i>
            </button>
          </div>
          
          <div class="space-y-3">
            <input id="deposit-amount" type="number" placeholder="Enter Amount" class="w-full p-4 rounded-xl input-field focus:border-green-500 outline-none">
            <input id="deposit-trxid" type="text" placeholder="Transaction ID / Hash" class="w-full p-4 rounded-xl input-field focus:border-green-500 outline-none">
          </div>
          <button onclick="handleDeposit()" class="w-full mt-6 p-4 rounded-xl bg-gradient-to-r from-emerald-500 to-green-600 font-bold text-white shadow-lg shadow-emerald-500/20 btn-anim">Verify Payment</button>
        </div>
      </div>

      <div id="history-page" class="p-5 space-y-6 sub-page">
        <h2 class="text-xl font-bold text-center mb-6">Transaction History</h2>
        <div id="full-transaction-list" class="space-y-3">
          <p class="text-center text-gray-500 text-sm">Loading...</p>
        </div>
      </div>

      <div id="wallet-page" class="p-5 space-y-6 sub-page">
        <h2 class="text-xl font-bold text-center mb-6">Withdraw Funds</h2>
        <div class="bg-gray-800 p-6 rounded-2xl text-center border border-gray-700">
          <p class="text-gray-400 text-sm mb-2">Available Balance</p>
          <p class="text-4xl font-black text-white mb-6"><span id="wallet-coin-balance">0.00</span> <span class="text-yellow-500 text-2xl">ü™ô</span></p>
          
          <p class="text-sm text-gray-400 mb-2 text-left">Select Withdrawal Method</p>
          
          <div class="grid grid-cols-2 gap-3 mb-6">
            <button onclick="selectWithdrawMethod('Binance', 'Wallet Address')" class="bg-[#1a1a1a] border border-gray-700 p-4 rounded-xl hover:border-yellow-500 transition-colors flex flex-col items-center gap-2">
              <img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/Binance_Logo.svg" alt="Binance" class="w-10 h-10 object-contain">
              <span class="text-xs font-bold">Binance</span>
            </button>
            <button onclick="selectWithdrawMethod('Nagad', 'Nagad Number')" class="bg-[#1a1a1a] border border-gray-700 p-4 rounded-xl hover:border-orange-600 transition-colors flex flex-col items-center gap-2">
              <img src="https://freelogopng.com/images/all_img/1679248787Nagad-Logo.png" alt="Nagad" class="w-14 h-10 object-contain">
              <span class="text-xs font-bold">Nagad</span>
            </button>
            <button onclick="selectWithdrawMethod('Bkash', 'Bkash Number')" class="bg-[#1a1a1a] border border-gray-700 p-4 rounded-xl hover:border-pink-600 transition-colors flex flex-col items-center gap-2">
              <img src="https://freelogopng.com/images/all_img/1656234745bkash-app-logo-png.png" alt="Bkash" class="w-14 h-10 object-contain">
              <span class="text-xs font-bold">Bkash</span>
            </button>
            <button onclick="selectWithdrawMethod('PhonePe', 'PhonePe Number')" class="bg-[#1a1a1a] border border-gray-700 p-4 rounded-xl hover:border-indigo-500 transition-colors flex flex-col items-center gap-2">
              <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/71/PhonePe_Logo.svg/512px-PhonePe_Logo.svg.png" alt="PhonePe" class="w-14 h-10 object-contain">
              <span class="text-xs font-bold">PhonePe</span>
            </button>
          </div>

          <div id="withdraw-form" class="hidden bg-[#0f0f0f] p-4 rounded-2xl border border-gray-600 animate-fade-in text-left">
            <h3 class="font-bold text-white mb-4">Withdraw via <span id="withdraw-method-title" class="text-orange-500">...</span></h3>
            <div class="space-y-3">
              <input id="withdraw-number" type="text" placeholder="Account Number" class="w-full p-4 rounded-xl input-field focus:border-orange-500 outline-none">
              
              <input id="withdraw-amount" type="number" placeholder="Amount (Loading...)" class="w-full p-4 rounded-xl input-field focus:border-orange-500 outline-none">
            </div>
            <button onclick="handleWithdrawal()" class="w-full mt-6 p-4 rounded-xl bg-gradient-to-r from-orange-500 to-red-600 font-bold text-white shadow-lg shadow-orange-500/20 btn-anim">Submit Request</button>
            <p class="text-xs text-gray-500 mt-2 text-center" id="min-withdrawal-info">Minimum withdrawal: Loading...</p>
          </div>

        </div>
      </div>

      <div id="refer-page" class="p-5 space-y-6 sub-page">
        <h2 class="text-xl font-bold text-center">Refer & Earn</h2>
        <div class="bg-gray-800 p-6 rounded-2xl text-center border border-gray-700">
          <div class="w-16 h-16 bg-blue-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-500">
            <i data-lucide="users" class="w-8 h-8"></i>
          </div>
          <p class="text-gray-400 mb-6 text-sm">Share your code with friends and earn extra coins!</p>
          
          <div class="bg-[#0f0f0f] p-4 rounded-xl flex items-center justify-between border border-dashed border-gray-600 mb-6">
            <span id="referral-code" class="text-xl font-mono font-bold text-orange-500 tracking-widest">LOADING</span>
            <button id="copy-code-btn" class="p-2 hover:bg-gray-800 rounded-lg transition-colors"><i data-lucide="copy" class="w-5 h-5 text-gray-400"></i></button>
          </div>
          
          <button id="share-btn" class="w-full p-4 rounded-xl bg-blue-600 font-bold text-white shadow-lg shadow-blue-500/20 btn-anim flex items-center justify-center gap-2">
            <i data-lucide="share-2" class="w-5 h-5"></i> Share Now
          </button>
        </div>
      </div>

      <div id="contact-page" class="p-5 space-y-6 sub-page">
        <h2 class="text-xl font-bold text-center">Support Center</h2>
        <p class="text-center text-gray-400 text-sm mb-4">Have questions? Reach out to us!</p>
        
        <div class="grid grid-cols-2 gap-4">
            <a id="link-whatsapp" href="#" target="_blank" class="bg-green-900/20 border border-green-600/50 p-4 rounded-xl flex flex-col items-center gap-2 hover:bg-green-600/30 transition-all group">
               <div class="p-3 bg-green-600 rounded-full text-white group-hover:scale-110 transition-transform shadow-lg shadow-green-600/40">
                 <i data-lucide="message-circle" class="w-6 h-6"></i>
               </div>
               <span class="font-bold text-green-500 group-hover:text-green-300 text-sm">WhatsApp</span>
            </a>
            
            <a id="link-telegram" href="#" target="_blank" class="bg-blue-900/20 border border-blue-500/50 p-4 rounded-xl flex flex-col items-center gap-2 hover:bg-blue-600/30 transition-all group">
               <div class="p-3 bg-blue-500 rounded-full text-white group-hover:scale-110 transition-transform shadow-lg shadow-blue-500/40">
                 <i data-lucide="send" class="w-6 h-6"></i>
               </div>
               <span class="font-bold text-blue-400 group-hover:text-blue-200 text-sm">Telegram</span>
            </a>

            <a id="link-email" href="#" class="bg-red-900/20 border border-red-500/50 p-4 rounded-xl flex flex-col items-center gap-2 hover:bg-red-600/30 transition-all group">
               <div class="p-3 bg-red-500 rounded-full text-white group-hover:scale-110 transition-transform shadow-lg shadow-red-500/40">
                 <i data-lucide="mail" class="w-6 h-6"></i>
               </div>
               <span class="font-bold text-red-400 group-hover:text-red-200 text-sm">Email</span>
            </a>

            <a id="link-phone" href="#" class="bg-purple-900/20 border border-purple-500/50 p-4 rounded-xl flex flex-col items-center gap-2 hover:bg-purple-600/30 transition-all group">
               <div class="p-3 bg-purple-500 rounded-full text-white group-hover:scale-110 transition-transform shadow-lg shadow-purple-500/40">
                 <i data-lucide="phone" class="w-6 h-6"></i>
               </div>
               <span class="font-bold text-purple-400 group-hover:text-purple-200 text-sm">Call Us</span>
            </a>
        </div>
      </div>

      <div id="profile-page" class="p-5 space-y-6 sub-page">
        <div class="text-center pt-4">
          <div class="w-24 h-24 bg-gradient-to-br from-gray-700 to-gray-800 rounded-full flex items-center justify-center mb-4 mx-auto border-4 border-gray-800 shadow-xl">
             <i data-lucide="user" class="w-10 h-10 text-gray-400"></i>
          </div>
          <h2 id="profile-name" class="text-2xl font-bold text-white">Loading...</h2>
          <p id="profile-email" class="text-gray-500 text-sm">...</p>
        </div>
        
        <div class="bg-gray-800 p-5 rounded-2xl border border-gray-700">
          <h3 class="font-semibold mb-4 flex items-center gap-2"><i data-lucide="shield" class="w-4 h-4 text-green-500"></i> Security</h3>
          <div class="bg-[#0f0f0f] p-3 rounded-xl border border-gray-700">
             <p class="text-xs text-gray-500 mb-1">Device ID & IP</p>
             <p id="current-device-info" class="text-xs font-mono text-gray-300 break-all"></p>
          </div>
          <p class="text-xs text-gray-500 mt-3 flex items-center gap-1"><i data-lucide="info" class="w-3 h-3"></i> Only one device allowed per account.</p>
        </div>
        
        <button id="logout-btn" class="w-full p-4 rounded-xl bg-red-500/10 text-red-500 border border-red-500/50 font-bold hover:bg-red-500 hover:text-white transition-all btn-anim">Logout</button>
      </div>
    </main>

    <nav class="bottom-nav fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-[#0f0f0f]/90 backdrop-blur-lg border-t border-gray-800 grid grid-cols-5 py-3 z-40">
      <a href="#" class="nav-link active flex flex-col items-center gap-1 transition-colors" data-page="home-page">
        <i data-lucide="home" class="w-5 h-5"></i>
        <span class="text-[10px] font-medium">Home</span>
      </a>
      <a href="#" class="nav-link text-gray-500 flex flex-col items-center gap-1 transition-colors hover:text-gray-300" data-page="wallet-page">
        <i data-lucide="wallet" class="w-5 h-5"></i>
        <span class="text-[10px] font-medium">Wallet</span>
      </a>
      <a href="#" class="nav-link text-gray-500 flex flex-col items-center gap-1 transition-colors hover:text-gray-300" data-page="refer-page">
        <i data-lucide="users" class="w-5 h-5"></i>
        <span class="text-[10px] font-medium">Refer</span>
      </a>
      <a href="#" class="nav-link text-gray-500 flex flex-col items-center gap-1 transition-colors hover:text-gray-300" data-page="contact-page">
        <i data-lucide="headset" class="w-5 h-5"></i>
        <span class="text-[10px] font-medium">Contact</span>
      </a>
      <a href="#" class="nav-link text-gray-500 flex flex-col items-center gap-1 transition-colors hover:text-gray-300" data-page="profile-page">
        <i data-lucide="user" class="w-5 h-5"></i>
        <span class="text-[10px] font-medium">Profile</span>
      </a>
    </nav>
  </div>

  <div id="custom-alert" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-6 backdrop-blur-sm">
    <div class="bg-gray-800 rounded-2xl p-6 w-full max-w-xs text-center border border-gray-700 shadow-2xl">
      <div class="w-12 h-12 bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4">
        <i data-lucide="info" class="w-6 h-6 text-orange-500"></i>
      </div>
      <p id="alert-message" class="mb-6 font-medium text-gray-200"></p>
      <button id="alert-ok-btn" class="w-full bg-orange-500 text-white font-bold py-3 rounded-xl btn-anim">OK</button>
    </div>
  </div>

  <script type="module">
    // --- FIREBASE CONFIGURATION ---
    const firebaseConfig = {
      apiKey: "AIzaSyARBSgxkAkBbtG213IlfSRif6Y2-rS-_CE",
      authDomain: "free-earn-money-24-8fa78.firebaseapp.com",
      databaseURL: "https://free-earn-money-24-8fa78-default-rtdb.firebaseio.com",
      projectId: "free-earn-money-24-8fa78",
      storageBucket: "free-earn-money-24-8fa78.firebasestorage.app",
      messagingSenderId: "104446443510",
      appId: "1:104446443510:web:3b3ce06fbfb1fbe91591d7"
    };

    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, updateDoc, collection, addDoc, serverTimestamp, query, where, getDocs, orderBy, limit, deleteDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    let currentUser = null;
    let userData = null;
    let appConfig = { minWithdrawal: 5000, dailyAdLimit: 15 };
    let userIP = null;
    let deviceId = null;
    let selectedDepositMethod = null;
    let selectedWithdrawMethod = null;
    let adminPaymentMethods = {}; 

    const loader = document.getElementById('loader');
    const timerModal = document.getElementById('timer-modal');
    const countdownDisplay = document.getElementById('countdown-display');
    const ipWarning = document.getElementById('ip-warning');

    // Get IP Address
    async function getIPAddress() {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        return data.ip;
      } catch (error) {
        return 'unknown';
      }
    }

    // Generate Device ID
    function generateDeviceId() {
      let deviceId = localStorage.getItem('device_id');
      if (!deviceId) {
        deviceId = 'dev_' + Math.random().toString(36).substring(2, 15) + 
                   Math.random().toString(36).substring(2, 15);
        localStorage.setItem('device_id', deviceId);
      }
      return deviceId;
    }

    // Check Device/IP Security
    async function checkDeviceSecurity() {
      const userRef = doc(db, "users", currentUser.uid);
      const userSnap = await getDoc(userRef);
      
      if (userSnap.exists()) {
        const user = userSnap.data();
        
        if (user.registeredDevice && user.registeredDevice.deviceId) {
          if (user.registeredDevice.deviceId !== deviceId) {
            ipWarning.style.display = 'block';
            showAlert("‚ö†Ô∏è Multiple device detected! Please use your registered device.");
            return false;
          }
          if (user.registeredDevice.ip && user.registeredDevice.ip !== userIP) {
            await updateDoc(userRef, { 'lastIPChange': serverTimestamp() });
          }
        } else {
          await updateDoc(userRef, {
            registeredDevice: {
              deviceId: deviceId,
              ip: userIP,
              registeredAt: serverTimestamp()
            }
          });
        }
      }
      return true;
    }

    // Block Multiple Logins
    async function checkActiveSession() {
      const sessionsRef = collection(db, "active_sessions");
      const q = query(sessionsRef, where("userId", "==", currentUser.uid));
      const querySnapshot = await getDocs(q);
      
      if (!querySnapshot.empty) {
        const session = querySnapshot.docs[0].data();
        if (session.deviceId !== deviceId) {
          ipWarning.style.display = 'block';
          showAlert("Another device is already logged in with this account.");
          await signOut(auth);
          return false;
        }
      }
      
      await setDoc(doc(db, "active_sessions", currentUser.uid), {
        userId: currentUser.uid,
        deviceId: deviceId,
        ip: userIP,
        lastActive: serverTimestamp()
      });
      
      return true;
    }

    // Clean up session on logout
    async function cleanupSession() {
      if (currentUser) {
        try {
          await deleteDoc(doc(db, "active_sessions", currentUser.uid));
        } catch (e) {
          console.log("Session cleanup error:", e);
        }
      }
    }

    window.onload = async () => {
      lucide.createIcons();
      setupEventListeners();
      
      userIP = await getIPAddress();
      deviceId = generateDeviceId();
      
      onAuthStateChanged(auth, handleAuthStateChange);
    };

    async function handleAuthStateChange(user) {
      if (user) {
        currentUser = user;
        showLoader(true);
        const sessionValid = await checkActiveSession();
        if (!sessionValid) { showLoader(false); return; }
        
        await fetchUserData();
        listenToAppConfig(); 
        await fetchAdminWallets(); 
        listenForGlobalNotifications(); 
        fetchSupportInfo(); // NEW: Load contact info from DB
        await checkDeviceSecurity();
        
        updateUI();
        showMainPage('app-container');
        navigateTo('home-page');
        showLoader(false);
      } else {
        await cleanupSession();
        showMainPage('auth-section');
      }
    }

    async function fetchUserData() {
      const userRef = doc(db, "users", currentUser.uid);
      const snap = await getDoc(userRef);
      if (snap.exists()) {
        userData = snap.data();
      } else {
        const referralCode = Math.random().toString(36).substring(2, 8).toUpperCase();
        userData = {
          uid: currentUser.uid,
          name: currentUser.displayName || "User",
          email: currentUser.email,
          balance: 50,
          referralCode: referralCode,
          dailyAdCount: 0,
          lastAdWatchDate: new Date().toISOString().split('T')[0],
          registeredDevice: { deviceId: deviceId, ip: userIP, registeredAt: serverTimestamp() }
        };
        await setDoc(userRef, userData);
      }
    }

    // --- UPDATED: Real-time Config Listener ---
    function listenToAppConfig() {
      onSnapshot(doc(db, "config", "main"), (doc) => {
        if (doc.exists()) {
          appConfig = doc.data();
          console.log("App Config Updated:", appConfig);
          updateUI(); // Refresh UI when config changes
        }
      });
    }

    // --- NEW: Fetch Admin Wallets ---
    async function fetchAdminWallets() {
        try {
            // Also listen to wallet changes in real-time
            onSnapshot(doc(db, "config", "payment_methods"), (doc) => {
                if(doc.exists()) {
                    adminPaymentMethods = doc.data();
                    console.log("Admin Wallets Updated", adminPaymentMethods);
                }
            });
        } catch(e) { console.error("Error fetching wallets", e); }
    }

    // --- NEW: Global Notification Listener ---
    function listenForGlobalNotifications() {
        const q = query(collection(db, "global_notifications"), orderBy("createdAt", "desc"), limit(1));
        onSnapshot(q, (snapshot) => {
            if (!snapshot.empty) {
                const data = snapshot.docs[0].data();
                const text = `${data.title}: ${data.body}`;
                const bar = document.getElementById('global-notification-bar');
                const msg = document.getElementById('notification-text');
                
                msg.textContent = text;
                bar.classList.remove('hidden');
            }
        });
    }

    // --- NEW: FETCH SUPPORT INFO ---
    function fetchSupportInfo() {
        onSnapshot(doc(db, "config", "support_info"), (doc) => {
            if (doc.exists()) {
                const data = doc.data();
                
                // Helper to ensure URL has protocol
                const ensureProtocol = (url, type) => {
                    if (!url) return "#";
                    if (type === 'email') return `mailto:${url.replace('mailto:', '')}`;
                    if (type === 'phone') return `tel:${url.replace('tel:', '')}`;
                    
                    // For web links like WhatsApp/Telegram
                    if (!url.startsWith('http://') && !url.startsWith('https://')) {
                        return `https://${url}`;
                    }
                    return url;
                };

                if(data.whatsapp) document.getElementById('link-whatsapp').href = ensureProtocol(data.whatsapp);
                if(data.telegram) document.getElementById('link-telegram').href = ensureProtocol(data.telegram);
                if(data.email) document.getElementById('link-email').href = ensureProtocol(data.email, 'email');
                if(data.phone) document.getElementById('link-phone').href = ensureProtocol(data.phone, 'phone');
            }
        });
    }

    function updateUI() {
      if (!userData) return;
      
      const balance = typeof userData.balance === 'number' ? userData.balance : 0;
      const formattedBalance = balance.toFixed(2);
      const dollarValue = (balance / 1000) * 0.01;

      document.getElementById('coin-balance').textContent = formattedBalance;
      document.getElementById('dollar-balance').textContent = `‚âà $${dollarValue.toFixed(4)}`;
      document.getElementById('wallet-coin-balance').textContent = formattedBalance;
      document.getElementById('profile-name').textContent = userData.name;
      document.getElementById('profile-email').textContent = userData.email;
      document.getElementById('referral-code').textContent = userData.referralCode;
      
      const deviceInfo = document.getElementById('current-device-info');
      if (deviceInfo) deviceInfo.textContent = `${deviceId.substring(0, 12)}... | IP: ${userIP}`;
      
      const today = new Date().toISOString().split('T')[0];
      const count = userData.lastAdWatchDate === today ? userData.dailyAdCount : 0;
      
      // Update Daily Limit UI
      const limit = appConfig.dailyAdLimit || 15;
      document.getElementById('ads-left-count').textContent = Math.max(0, limit - count);

      // Update Min Withdrawal Text (BOTH PLACEHOLDER AND HELPER TEXT)
      const minWithdraw = appConfig.minWithdrawal || 5000;
      
      const minInfo = document.getElementById('min-withdrawal-info');
      if(minInfo) minInfo.textContent = `Minimum withdrawal: ${minWithdraw} coins`;

      const amountInput = document.getElementById('withdraw-amount');
      if(amountInput) amountInput.placeholder = `Amount (Min ${minWithdraw})`;
    }

    window.navigateTo = function(pageId) {
      document.querySelectorAll(".sub-page").forEach(p => p.classList.remove("active"));
      document.getElementById(pageId).classList.add("active");
      document.querySelectorAll(".nav-link").forEach(link => {
        link.classList.remove("active", "text-orange-500", "text-gray-500");
        if (link.dataset.page === pageId) {
          link.classList.add("active", "text-orange-500");
        } else {
          link.classList.add("text-gray-500");
        }
      });
      if(pageId === 'history-page') loadTransactionHistory();
    }

    // --- UPDATED DEPOSIT FUNCTION FOR DYNAMIC ADDRESS ---
    window.selectDepositMethod = function(methodName) {
      selectedDepositMethod = methodName; // "Binance", "Nagad" etc
      const key = methodName.toLowerCase(); // "binance", "nagad" etc
      
      // Look up address from Admin Panel data
      let realAddress = "No address set by Admin";
      if(adminPaymentMethods && adminPaymentMethods[key]) {
          realAddress = adminPaymentMethods[key];
      }

      document.getElementById('selected-method-name').textContent = methodName;
      document.getElementById('payment-details').textContent = realAddress;
      document.getElementById('deposit-form').classList.remove('hidden');
    }

    // --- UPDATED COPY FUNCTION WITH FALLBACK ---
    window.copyPaymentAddress = function() {
        const textToCopy = document.getElementById('payment-details').innerText;

        if (!textToCopy || textToCopy === "No address set by Admin" || textToCopy === "Loading address...") {
            showAlert("Nothing to copy!");
            return;
        }

        // Try standard API (Works on HTTPS)
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(textToCopy).then(() => {
                showAlert("Copied to clipboard!");
            }).catch(err => {
                fallbackCopyText(textToCopy); // Use fallback if fails
            });
        } else {
            fallbackCopyText(textToCopy); // Use fallback if not HTTPS
        }
    }

    // --- FALLBACK COPY METHOD (WORKS EVERYWHERE) ---
    function fallbackCopyText(text) {
        const textArea = document.createElement("textarea");
        textArea.value = text;
        
        // Hide element but keep it part of DOM
        textArea.style.position = "fixed";
        textArea.style.left = "-9999px";
        textArea.style.top = "0";
        document.body.appendChild(textArea);
        
        textArea.focus();
        textArea.select();
        
        try {
            const successful = document.execCommand('copy');
            if(successful) showAlert("Copied!");
            else showAlert("Copy failed.");
        } catch (err) {
            showAlert("Copy failed.");
        }
        
        document.body.removeChild(textArea);
    }

    window.handleDeposit = async function() {
      const amount = parseFloat(document.getElementById('deposit-amount').value);
      const trxId = document.getElementById('deposit-trxid').value;

      if (!amount || !trxId) return showAlert("Please enter amount and Transaction ID");
      if (!selectedDepositMethod) return showAlert("Select a payment method");

      showLoader(true);
      try {
        await addDoc(collection(db, "deposits"), {
          userId: currentUser.uid,
          amount: amount,
          method: selectedDepositMethod,
          trxId: trxId,
          status: "pending",
          createdAt: serverTimestamp(),
          type: "deposit"
        });
        showAlert("Deposit submitted for review!");
        document.getElementById('deposit-amount').value = "";
        document.getElementById('deposit-trxid').value = "";
        document.getElementById('deposit-form').classList.add('hidden');
        navigateTo('history-page');
      } catch (e) {
        showAlert("Error submitting deposit: " + e.message);
      }
      showLoader(false);
    }

    // --- WITHDRAWAL FUNCTIONS ---
    window.selectWithdrawMethod = function(method, placeholder) {
      selectedWithdrawMethod = method;
      document.getElementById('withdraw-method-title').textContent = method;
      document.getElementById('withdraw-number').placeholder = placeholder;
      document.getElementById('withdraw-form').classList.remove('hidden');
    }

    window.handleWithdrawal = async function() {
      if (userData.registeredDevice && userData.registeredDevice.deviceId !== deviceId) {
        return showAlert("Withdrawal is only allowed from your registered device.");
      }
      
      const amount = parseInt(document.getElementById('withdraw-amount').value);
      const number = document.getElementById('withdraw-number').value;

      if (!amount || !number) return showAlert("Please fill all fields");
      if (!selectedWithdrawMethod) return showAlert("Select a withdrawal method");

      if (amount < appConfig.minWithdrawal) return showAlert(`Minimum withdrawal is ${appConfig.minWithdrawal} coins`);
      if (amount > userData.balance) return showAlert("Insufficient balance");

      showLoader(true);
      try {
        await addDoc(collection(db, "withdrawals"), {
          userId: currentUser.uid,
          amount: amount,
          method: selectedWithdrawMethod,
          number: number,
          status: "pending",
          createdAt: serverTimestamp(),
          deviceId: deviceId,
          ip: userIP,
          type: "withdraw"
        });
        const newBalance = userData.balance - amount;
        await updateDoc(doc(db, "users", currentUser.uid), { balance: newBalance });
        userData.balance = newBalance;
        updateUI();
        showAlert("Withdrawal request sent!");
        document.getElementById('withdraw-amount').value = "";
        document.getElementById('withdraw-number').value = "";
        document.getElementById('withdraw-form').classList.add('hidden');
        navigateTo('history-page');
      } catch (e) { showAlert("Error processing withdrawal"); }
      showLoader(false);
    }

    // --- HISTORY FUNCTION ---
    window.loadTransactionHistory = async function() {
      const list = document.getElementById('full-transaction-list');
      list.innerHTML = '<p class="text-center text-gray-500 text-sm">Loading...</p>';
      
      const withdrawalsQuery = query(collection(db, "withdrawals"), where("userId", "==", currentUser.uid), orderBy("createdAt", "desc"), limit(10));
      const depositsQuery = query(collection(db, "deposits"), where("userId", "==", currentUser.uid), orderBy("createdAt", "desc"), limit(10));

      const [withdrawalsSnap, depositsSnap] = await Promise.all([getDocs(withdrawalsQuery), getDocs(depositsQuery)]);
      
      let transactions = [];
      
      withdrawalsSnap.forEach(doc => transactions.push({ ...doc.data(), type: 'withdraw', date: doc.data().createdAt }));
      depositsSnap.forEach(doc => transactions.push({ ...doc.data(), type: 'deposit', date: doc.data().createdAt }));
      
      // Sort mixed array by date
      transactions.sort((a, b) => (b.date?.seconds || 0) - (a.date?.seconds || 0));

      list.innerHTML = "";
      if (transactions.length === 0) {
        list.innerHTML = '<p class="text-center text-gray-500 text-sm">No transactions found.</p>';
        return;
      }

      transactions.forEach(t => {
        const isDeposit = t.type === 'deposit';
        const colorClass = isDeposit ? 'text-green-500' : 'text-red-500';
        const icon = isDeposit ? 'arrow-down-left' : 'arrow-up-right';
        const sign = isDeposit ? '+' : '-';
        
        list.innerHTML += `
          <div class="bg-gray-800 p-4 rounded-xl flex justify-between items-center text-sm border border-gray-700">
            <div class="flex items-center gap-3">
              <div class="p-2 rounded-lg bg-gray-700 ${colorClass}">
                <i data-lucide="${icon}" class="w-5 h-5"></i>
              </div>
              <div>
                <p class="font-bold text-gray-200">${t.method}</p>
                <p class="text-xs text-gray-500">${t.trxId || t.number}</p>
              </div>
            </div>
            <div class="text-right">
               <p class="font-bold ${colorClass}">${sign}${t.amount}</p>
               <p class="text-[10px] font-bold uppercase ${t.status === 'pending' ? 'text-yellow-500' : 'text-green-500'}">${t.status}</p>
            </div>
          </div>`;
      });
      lucide.createIcons();
    }

    function startTimerTask(seconds, reward) {
      timerModal.classList.remove('hidden');
      let timeLeft = seconds;
      countdownDisplay.textContent = timeLeft;

      const interval = setInterval(async () => {
        timeLeft--;
        countdownDisplay.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(interval);
          timerModal.classList.add('hidden');
          await addReward(reward);
        }
      }, 1000);
    }

    async function validateTask() {
      if (userData.registeredDevice && userData.registeredDevice.deviceId !== deviceId) {
        showAlert("Please use your registered device to complete tasks.");
        return false;
      }
      const today = new Date().toISOString().split('T')[0];
      const currentCount = userData.lastAdWatchDate === today ? userData.dailyAdCount : 0;
      if (currentCount >= (appConfig.dailyAdLimit || 15)) {
        showAlert("‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑!");
        return false;
      }
      return true;
    }

    window.visitWebsite = async function(url, seconds) {
      if (!await validateTask()) return;
      window.open(url, '_blank');
      
      timerModal.classList.remove('hidden');
      let timeLeft = seconds;
      countdownDisplay.textContent = timeLeft;

      const interval = setInterval(async () => {
        timeLeft--;
        countdownDisplay.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(interval);
          timerModal.classList.add('hidden');
          await addReward(50);
        }
      }, 1000);
    }

    async function addReward(reward) {
      if (currentUser) {
        try { await updateDoc(doc(db, "active_sessions", currentUser.uid), { lastActive: serverTimestamp() }); } catch (e) {}
      }
      const today = new Date().toISOString().split('T')[0];
      const userRef = doc(db, "users", currentUser.uid);
      
      let newCount = 1;
      if(userData.lastAdWatchDate === today) {
        newCount = (userData.dailyAdCount || 0) + 1;
      }

      const newBalance = (userData.balance || 0) + reward;
      await updateDoc(userRef, {
        balance: newBalance,
        dailyAdCount: newCount,
        lastAdWatchDate: today
      });

      userData.balance = newBalance;
      userData.dailyAdCount = newCount;
      userData.lastAdWatchDate = today;
      
      updateUI();
      showAlert(`‡¶Ö‡¶≠‡¶ø‡¶®‡¶®‡ßç‡¶¶‡¶®! ‡¶Ü‡¶™‡¶®‡¶ø ${reward} ‡¶ï‡ßü‡ßá‡¶® ‡¶™‡ßá‡ßü‡ßá‡¶õ‡ßá‡¶®‡•§`);
    }

    window.claimReward = async (type) => {
      if (!await validateTask()) return;
      if (type === 'dailyClick') return startTimerTask(30, 50);
      
      // CALL NEW SDK (10543110)
      if (typeof window.show_10543110 === 'function') {
        showLoader(true);
        try {
          await window.show_10543110(); // Call the new function name
          await addReward(type === 'miniApp' ? 100 : 50);
        } catch (e) {
          showAlert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§");
        } finally {
          showLoader(false);
        }
      } else {
          // If SDK not loaded or function name different, fallback
          console.error("Monetag SDK function show_10543110 not found.");
          showAlert("Ad not available.");
      }
    };

    async function handleSignup() {
      const name = document.getElementById('signup-name').value;
      const email = document.getElementById('signup-email').value;
      const pass = document.getElementById('signup-password').value;
      if (!name || !email || !pass) return showAlert("‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ò‡¶∞ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
      
      showLoader(true);
      try {
        const res = await createUserWithEmailAndPassword(auth, email, pass);
        await updateProfile(res.user, { displayName: name });
        const userRef = doc(db, "users", res.user.uid);
        const referralCode = Math.random().toString(36).substring(2, 8).toUpperCase();
        await setDoc(userRef, {
          uid: res.user.uid,
          name: name,
          email: email,
          balance: 50,
          referralCode: referralCode,
          dailyAdCount: 0,
          lastAdWatchDate: new Date().toISOString().split('T')[0],
          registeredDevice: { deviceId: deviceId, ip: userIP, registeredAt: serverTimestamp() }
        });
      } catch (e) { 
        if (e.code === 'auth/email-already-in-use') showAlert("‡¶è‡¶á ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
        else showAlert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ‡•§");
      }
      showLoader(false);
    }

    async function handleLogin() {
      const email = document.getElementById('login-email').value;
      const pass = document.getElementById('login-password').value;
      showLoader(true);
      try { await signInWithEmailAndPassword(auth, email, pass); }
      catch (e) { 
        if (e.code === 'auth/user-not-found') showAlert("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§");
        else if (e.code === 'auth/wrong-password') showAlert("‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
        else showAlert("‡¶≤‡¶ó‡¶ø‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
      }
      showLoader(false);
    }

    function setupEventListeners() {
      document.getElementById('signup-btn').onclick = handleSignup;
      document.getElementById('login-btn').onclick = handleLogin;
      document.getElementById('logout-btn').onclick = async () => { await cleanupSession(); await signOut(auth); };
      document.getElementById('copy-code-btn').onclick = () => {
        navigator.clipboard.writeText(userData.referralCode);
        showAlert("‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
      };
      document.querySelectorAll('.nav-link').forEach(l => {
        l.onclick = (e) => { e.preventDefault(); navigateTo(l.dataset.page); };
      });
      document.getElementById('show-signup').onclick = () => {
        document.getElementById('login-view').classList.add('hidden');
        document.getElementById('signup-view').classList.remove('hidden');
      };
      document.getElementById('show-login').onclick = () => {
        document.getElementById('signup-view').classList.add('hidden');
        document.getElementById('login-view').classList.remove('hidden');
      };

      // --- ADDED SHARE BUTTON LISTENER HERE ---
      document.getElementById('share-btn').onclick = async () => {
        if (!userData || !userData.referralCode) {
            showAlert("Referral code not loaded yet.");
            return;
        }

        const shareData = {
            title: 'Join FREE EARN MONEY 24',
            text: `Hey! I'm earning money daily with FREE EARN MONEY 24. Use my referral code: ${userData.referralCode} to join and get a bonus!`,
            url: window.location.href
        };

        // Try Native Share
        if (navigator.share) {
            try {
                await navigator.share(shareData);
            } catch (err) {
                console.log('Share canceled or failed', err);
            }
        } else {
            // Fallback to Clipboard
            const fullMessage = `${shareData.text}\n${shareData.url}`;
            navigator.clipboard.writeText(fullMessage).then(() => {
                showAlert("Link & Code copied to clipboard!");
            }).catch(() => {
                showAlert("Failed to share.");
            });
        }
      };
    }

    function showMainPage(id) {
      document.querySelectorAll('.main-page').forEach(p => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    function showLoader(s) { loader.classList.toggle('hidden', !s); }

    function showAlert(m) {
      document.getElementById('alert-message').textContent = m;
      document.getElementById('custom-alert').classList.remove('hidden');
      document.getElementById('alert-ok-btn').onclick = () => document.getElementById('custom-alert').classList.add('hidden');
    }
  </script>
</body>
</html>